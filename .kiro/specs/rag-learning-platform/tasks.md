# 实施计划

- [x] 1. 项目初始化和环境配置
  - 创建项目目录结构，包含前端(frontend)和后端(backend)目录
  - 配置conda环境，创建Python 3.12虚拟环境
  - 初始化Next.js 14项目，配置App Router和TypeScript
  - 初始化FastAPI项目，配置项目依赖和开发环境
  - 创建TOML配置文件模板，定义系统配置结构
  - _需求: 9.1, 9.2, 9.3_

- [x] 2. 数据库设计和初始化
  - [x] 2.1 创建SQLite数据库模式
    - 实现数据库连接和会话管理
    - 创建所有数据表的SQLAlchemy模型（users, knowledge_bases, documents, questions, answer_records, knowledge_points, review_records）
    - 编写数据库迁移脚本和初始化脚本
    - 创建数据库操作的基础CRUD类
    - _需求: 2.4, 5.1, 5.2_

  - [x] 2.2 配置ChromaDB向量数据库
    - 初始化ChromaDB客户端和连接配置
    - 创建文档向量集合和知识点向量集合
    - 实现向量数据的存储和检索接口
    - 编写向量数据库的测试用例
    - _需求: 2.5, 3.3_

- [x] 3. 用户认证系统
  - [x] 3.1 实现JWT认证后端
    - 创建用户模型和密码哈希处理
    - 实现JWT token生成、验证和刷新逻辑
    - 创建认证中间件，保护需要登录的API端点
    - 实现用户注册、登录、登出API端点
    - _需求: 9.1_

  - [x] 3.2 实现前端认证状态管理
    - 使用Zustand创建认证状态store
    - 实现登录、注册表单组件（使用React Hook Form + Zod）
    - 创建认证路由保护组件
    - 实现token自动刷新和过期处理
    - _需求: 9.1_

- [x] 4. 大模型集成基础设施
  - [x] 4.1 实现模型配置管理
    - 创建模型配置类，支持OpenAI API和Ollama配置
    - 实现配置文件读取和验证（TOML格式）
    - 创建模型切换和健康检查机制
    - 编写模型配置的单元测试
    - _需求: 1.1, 1.2, 1.3, 9.2_

  - [x] 4.2 集成LlamaIndex RAG引擎
    - 初始化LlamaIndex服务，配置嵌入模型（shaw/dmeta-embedding-zh-small-q4）
    - 实现文档加载器，支持PDF、EPUB、TXT、MD格式
    - 创建文档分块和向量化处理流程
    - 实现基于向量相似度的文档检索功能
    - _需求: 1.3, 2.1, 2.3_

- [ ] 5. 文档管理系统
  - [ ] 5.1 实现文档上传和存储
    - 创建文件上传API端点，支持多种文档格式
    - 实现文件存储管理，包括文件路径和元数据处理
    - 添加文件类型验证和大小限制
    - 创建文档预览功能
    - _需求: 2.1, 2.4_

  - [ ] 5.2 实现知识库管理
    - 创建知识库CRUD API端点
    - 实现知识库与文档的关联关系管理
    - 创建知识库列表和详情页面组件
    - 实现知识库的创建、编辑、删除功能
    - _需求: 2.2, 2.4_

  - [ ] 5.3 实现文档处理流程
    - 创建异步文档处理任务队列
    - 实现文档解析和文本提取功能
    - 集成向量化处理，将文档存储到ChromaDB
    - 添加处理状态跟踪和错误处理
    - _需求: 2.3, 2.5_

- [ ] 6. 智能问题生成系统
  - [ ] 6.1 实现问题生成核心逻辑
    - 创建问题生成服务，基于文档内容调用大模型
    - 实现问题质量评估和筛选机制
    - 创建问题与文档片段的关联存储
    - 添加问题难度分级功能
    - _需求: 3.1, 3.2, 3.3_

  - [ ] 6.2 创建问题管理界面
    - 实现问题生成的前端界面和操作流程
    - 创建问题列表和详情展示组件
    - 添加问题编辑和删除功能
    - 实现问题按知识库和文档的筛选功能
    - _需求: 3.4_

- [ ] 7. 答案评估系统
  - [ ] 7.1 实现答案评估引擎
    - 创建答案评估服务，调用大模型进行评分
    - 实现参考答案生成功能
    - 创建评估结果的结构化存储
    - 添加评估反馈的详细分析功能
    - _需求: 4.1, 4.2, 4.3_

  - [ ] 7.2 创建答题和评估界面
    - 实现答题界面，支持文本输入和提交
    - 创建评估结果展示组件，显示评分和反馈
    - 添加参考答案对比功能
    - 实现答题历史记录查看
    - _需求: 4.4_

- [ ] 8. 学习记录管理
  - [ ] 8.1 实现学习记录存储和查询
    - 创建学习记录的数据模型和API端点
    - 实现记录的增删改查功能
    - 添加按时间、知识库、评分等维度的筛选功能
    - 创建学习统计和进度分析功能
    - _需求: 5.1, 5.2, 5.3_

  - [ ] 8.2 创建学习记录管理界面
    - 实现学习记录列表和详情页面
    - 创建记录筛选和搜索功能
    - 添加学习进度可视化图表
    - 实现记录的编辑和删除操作
    - _需求: 5.4_

- [ ] 9. 知识点提取和管理
  - [ ] 9.1 实现知识点自动提取
    - 创建知识点提取服务，基于文档内容调用大模型
    - 实现知识点的重要性评估和分类
    - 创建知识点与文档的关联存储
    - 添加知识点的结构化组织功能
    - _需求: 6.1, 6.2_

  - [ ] 9.2 创建知识点管理界面
    - 实现知识点列表和详情展示
    - 创建知识点的手动编辑和补充功能
    - 添加知识点的分类和标签管理
    - 实现知识点的搜索和筛选功能
    - _需求: 6.3, 6.4_

- [ ] 10. 记忆曲线学习系统
  - [ ] 10.1 实现记忆曲线算法
    - 创建基于Anki算法的复习调度系统
    - 实现复习间隔计算和调整逻辑
    - 创建复习提醒和通知功能
    - 添加学习效果跟踪和统计
    - _需求: 8.1, 8.2, 8.3_

  - [ ] 10.2 创建复习学习界面
    - 实现复习模式的学习界面
    - 创建复习进度和统计展示
    - 添加复习提醒和计划管理
    - 实现复习效果的反馈收集
    - _需求: 8.4_

- [ ] 11. Anki导出功能
  - [ ] 11.1 实现Anki卡片生成
    - 集成Genanki库，创建Anki卡片生成服务
    - 实现问答记录到Anki卡片的转换
    - 实现知识点到Anki卡片的转换
    - 创建.apkg文件的生成和下载功能
    - _需求: 7.1, 7.2, 7.3_

  - [ ] 11.2 创建导出管理界面
    - 实现导出选项配置界面
    - 创建导出进度跟踪和状态显示
    - 添加导出历史记录管理
    - 实现批量导出和自定义筛选功能
    - _需求: 7.4_

- [ ] 12. 用户界面优化和完善
  - [ ] 12.1 实现响应式布局和主题
    - 使用Ant Design和Tailwind CSS创建清新简约的界面风格
    - 实现响应式布局，支持桌面和移动端
    - 创建统一的主题配置和样式系统
    - 添加深色模式支持
    - _需求: 10.1, 10.2_

  - [ ] 12.2 优化用户体验和交互
    - 实现页面加载状态和进度指示
    - 添加操作反馈和错误提示
    - 创建快捷键支持和操作指南
    - 实现数据的自动保存和恢复功能
    - _需求: 10.3, 10.4_

- [ ] 13. 系统集成和测试
  - [ ] 13.1 编写单元测试和集成测试
    - 为所有核心业务逻辑编写单元测试
    - 创建API端点的集成测试
    - 实现数据库操作的测试用例
    - 添加AI模型集成的Mock测试
    - _需求: 所有需求的测试覆盖_

  - [ ] 13.2 实现端到端测试
    - 使用Cypress创建完整的用户流程测试
    - 测试文档上传到问题生成的完整流程
    - 测试学习记录和复习系统的端到端功能
    - 验证Anki导出功能的完整性
    - _需求: 所有需求的端到端验证_

- [ ] 14. 部署和配置优化
  - [ ] 14.1 配置生产环境部署
    - 创建Docker容器化配置
    - 配置生产环境的数据库和文件存储
    - 实现环境变量和配置管理
    - 添加日志记录和监控配置
    - _需求: 9.1, 9.2, 9.3_

  - [ ] 14.2 性能优化和安全加固
    - 实现API限流和缓存策略
    - 添加文件上传的安全检查
    - 优化数据库查询和索引
    - 实现数据备份和恢复机制
    - _需求: 所有需求的性能和安全要求_