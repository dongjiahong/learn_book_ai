# 需求文档

## 介绍

基于RAG（检索增强生成）技术的智能学习平台，通过分析用户上传的文档自动生成学习问题，评估答案质量，并提供知识点总结。支持多种大模型接入（API和本地Ollama），具备完整的学习记录管理和Anki导出功能，帮助用户更高效地学习和复习文档内容。

## 需求

### 需求 1 - 大模型集成

**用户故事：** 作为学习者，我希望平台能够连接不同类型的大模型，这样我可以根据需要选择最适合的模型进行学习。

#### 验收标准

1. 当用户配置API模型时，系统应当支持OpenAI等主流API接口
2. 当用户选择本地模型时，系统应当支持Ollama本地部署
3. 当使用Ollama时，系统应当默认使用Qwen3:4b作为主模型，shaw/dmeta-embedding-zh-small-q4作为嵌入模型
4. 当模型配置发生变化时，系统应当能够无缝切换而不影响现有功能

### 需求 2 - 文档管理与处理

**用户故事：** 作为学习者，我希望能够上传和管理各种格式的学习文档，并将它们组织成知识库，这样我可以系统化地管理学习材料。

#### 验收标准

1. 当用户上传文档时，系统应当支持PDF、EPUB、TXT、MD格式
2. 当用户创建知识库时，系统应当允许在同一知识库中包含多个文档
3. 当文档上传完成时，系统应当自动进行文档解析和向量化处理
4. 当用户管理文档时，系统应当提供文档的增删改查功能
5. 当文档处理完成时，系统应当将向量数据存储到ChromaDB中

### 需求 3 - 智能问题生成

**用户故事：** 作为学习者，我希望系统能够基于文档内容自动生成相关问题，这样我可以测试自己对文档的理解程度。

#### 验收标准

1. 当文档分析完成时，系统应当通过大模型生成多个相关问题
2. 当生成问题时，系统应当确保问题覆盖文档的关键知识点
3. 当问题生成后，系统应当将问题与对应的文档片段关联
4. 当用户请求时，系统应当能够为特定文档或知识库生成新的问题

### 需求 4 - 答案评估与反馈

**用户故事：** 作为学习者，我希望系统能够评估我的答案质量并提供参考答案，这样我可以了解自己的学习效果并获得改进建议。

#### 验收标准

1. 当用户提交答案时，系统应当通过大模型评估答案的准确性和完整性
2. 当评估完成时，系统应当提供评分和详细的反馈意见
3. 当评估完成时，系统应当生成标准参考答案
4. 当评估结果生成时，系统应当将评估记录（10分制）保存到数据库中

### 需求 5 - 学习记录管理

**用户故事：** 作为学习者，我希望系统能够记录我的学习历史，包括问题、答案和评估结果，这样我可以追踪学习进度并进行复习。

#### 验收标准

1. 当用户完成问答时，系统应当记录问题、用户答案、参考答案和评估结果
2. 当用户查看历史时，系统应当提供问答记录的查询和筛选功能
3. 当用户需要复习时，系统应当支持按时间、知识库、评分等维度筛选记录
4. 当记录管理时，系统应当提供记录的编辑和删除功能

### 需求 6 - 知识点提取与总结

**用户故事：** 作为学习者，我希望系统能够自动提取文档的重要知识点，这样我可以快速了解文档的核心内容而无需完整阅读。

#### 验收标准

1. 当文档上传后，系统应当能够自动提取关键知识点
2. 当知识点生成时，系统应当按重要性和主题进行分类
3. 当用户查看时，系统应当以结构化方式展示知识点
4. 当用户需要时，系统应当支持知识点的手动编辑和补充

### 需求 7 - Anki集成与导出

**用户故事：** 作为学习者，我希望能够将问答和知识点导出为Anki格式，这样我可以在Anki中进行间隔重复学习。

#### 验收标准

1. 当用户选择导出时，系统应当支持将问答记录导出为Anki卡片包
2. 当用户选择导出时，系统应当支持将知识点导出为Anki卡片包
3. 当导出完成时，系统应当生成标准的.apkg格式文件
4. 当导出时，系统应当允许用户选择特定的知识库或时间范围

### 需求 8 - 记忆曲线学习

**用户故事：** 作为学习者，我希望在网站内也能够基于记忆曲线进行学习，这样我可以在不使用Anki的情况下也能获得科学的复习安排。

#### 验收标准

1. 当用户开始学习时，系统应当根据记忆曲线算法安排复习时间
2. 当复习时间到达时，系统应当提醒用户进行复习
3. 当用户完成复习时，系统应当根据掌握程度调整下次复习时间
4. 当学习进行时，系统应当提供学习进度和统计信息

### 需求 9 - 配置管理

**用户故事：** 作为用户，我希望能够通过配置文件管理系统设置，这样我可以方便地调整模型参数和系统行为。

#### 验收标准

1. 当系统启动时，系统应当读取TOML格式的配置文件
2. 当配置变更时，系统应当支持热重载或重启后生效
3. 当配置错误时，系统应当提供清晰的错误信息和默认值
4. 当用户修改配置时，系统应当验证配置的有效性

### 需求 10 - 用户界面设计

**用户故事：** 作为用户，我希望系统具有清新简约的界面设计，这样我可以专注于学习内容而不被复杂的界面分散注意力。

#### 验收标准

1. 当用户访问系统时，界面应当采用清新素净的设计风格
2. 当用户操作时，界面应当提供直观的导航和操作流程
3. 当显示内容时，界面应当合理组织信息层次和布局
4. 当用户交互时，界面应当提供及时的反馈和状态提示